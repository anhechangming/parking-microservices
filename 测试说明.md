前端   http://localhost 

RabbitMQ    http://localhost:15672

  - 用户名：admin
  - 密码：admin123

nacos控制台  http://localhost:8080

  - 用户名：nacos
  - 密码：nacos

## 前言  

## 数据库

### 1. 初始化用户数据库

  docker exec -i user-db mysql -uroot -proot_password parking_user_db < init-user-only.sql

  ### 2. 初始化停车业务数据库

  docker exec -i parking-db mysql -uroot -proot_password parking_business_db < init-parking-only.sql

  ### 3. 初始化费用数据库

  docker exec -i fee-db mysql -uroot -proot_password parking_fee_db < init-fee-only.sql

## 一、测试网关、负载均衡、熔断降级测试请运行 test_comprehensive.sh脚本

## 二、测试异步消息队列时运行  mq_test.sh

## 三、测试配置中心切换环境和动态刷新时请按照以下步骤(配置文件在nacosConfig目录下，需手动创建)

#### 1、观察之前的运行环境  测试配置

```bash
docker logs -f parking-user-service-8081 
curl http://localhost:8081/api/config/current
 curl http://localhost:8081/api/config/test-registration
```

#### 2、在控制台修改配置，测试动态刷新

```bash
curl http://localhost:8081/api/config/current
 curl http://localhost:8081/api/config/test-registration
```

#### 3、停止容器

```bash
docker stop parking-user-service-8081 parking-user-service-8091
docker rm  parking-user-service-8081 parking-user-service-8091
```

#### 4、切换环境

```bash
docker run -d --name parking-user-service-8081 -p 8081:8081 --network parking-microservices-openfeign_parking-network -e SPRING_PROFILES_ACTIVE=test -e SPRING_CLOUD_NACOS_CONFIG_NAMESPACE=test -e SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=parking-nacos:8848 -e SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=parking-nacos:8848 parking-microservices-openfeign-user-service-1:latest


docker run -d --name parking-user-service-8091 -p 8091:8091 --network parking-microservices-openfeign_parking-network -e SPRING_PROFILES_ACTIVE=test -e SPRING_CLOUD_NACOS_CONFIG_NAMESPACE=test -e SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=parking-nacos:8848 -e SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=parking-nacos:8848 parking-microservices-openfeign-user-service-2:latest
```

#### 5、查看日志，确认切换环境

```bash
docker logs -f parking-user-service-8081
```

#### 6、测试配置

```bash
curl http://localhost:8081/api/config/current
 curl http://localhost:8081/api/config/test-registration
```

